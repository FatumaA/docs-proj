---
import StarlightPage from "@astrojs/starlight/components/StarlightPage.astro";
import { Icon } from "astro-icon/components";
import Image from "astro:assets";
import { getAllCharactersQuery } from "../queries/get-episodes";
import { type Character } from "../models/rick-morty";

export const prerender = false;
const response = await fetch("https://rickandmortyapi.com/graphql", {
	method: "POST",
	headers: { "Content-Type": "application/json" },
	body: JSON.stringify({
		query: getAllCharactersQuery,
	}),
});

const {
	data: {
		characters: { results },
	},
} = await response.json();

console.log("First episode name:", results);
---

<StarlightPage
	frontmatter={{
		title: "Rick and Morty Character Explorer",
		template: "splash",
	}}
>
	<div class="container mx-auto my-1 text-center text-justify-center">
		<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
			{
				results.map((character: Character) => (
					<div class="border rounded-lg">
						<img
							src={character.image}
							alt={character.name}
							class="w-full h-64 object-contain rounded-lg"
						/>
						<div class="flex flex-row items-center justify-center gap-4 px-2">
							<p class="">{character.name}</p>
							<a
								href="/rick-morty-exp/xx"
								rel="noopener noreferrer"
								class="text-black"
							>
								<Icon
									name="arrow"
									size={24}
									class=" cursor-pointer rotate-90"
								/>
							</a>
						</div>
					</div>
				))
			}
		</div>
	</div>
</StarlightPage>
